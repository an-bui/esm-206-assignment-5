---
title: "Assignment 5 scratch paper"
author: "An Bui"
date: "11/28/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#### load packages ####
library(tidyverse)
library(stargazer)

#### read in data ####
phd_fields_sex <- read_csv("phds_field_sex.csv")
phd_fields_field <- read_csv("phds_field_field.csv")
faculty_salary <- read_csv("faculty_salary.csv")
```

##### Is there a significant association between sex and specialty in 1985, 2000, and 2015?
```{r an attempt at wrangling}
#### chi square for 1985 ####
fields_85 <- phd_fields_field %>%
  filter(year == "1985",
         field == "lifesci" |
           field == "physsci" |
           field == "math" |
           field == "psych" |
           field == "eng" |
           field == "edu" |
           field == "arts" |
           field == "other") %>% 
  select("male", "female")

rownames(fields_85) <- c("lifesci", "physsci", "math", "psych", "eng", "edu", "arts", "other")

fields_85_prop <- phd_fields_field %>%
  filter(year == "1985",
         field == "lifesci" |
           field == "physsci" |
           field == "math" |
           field == "psych" |
           field == "eng" |
           field == "edu" |
           field == "arts" |
           field == "other") %>% 
  select("male_prop", "female_prop")

rownames(fields_85_prop) <- c("lifesci", "physsci", "math", "psych", "eng", "edu", "arts", "other")

fields85_chi <- chisq.test(fields_85)
fields85_chi
# proportions are different, no shit

#### chi square for 2000 ####

fields_00 <- phd_fields_field %>%
  filter(year == "2000",
         field == "lifesci" |
           field == "physsci" |
           field == "math" |
           field == "psych" |
           field == "eng" |
           field == "edu" |
           field == "arts" |
           field == "other") %>% 
  select("male", "female")

rownames(fields_00) <- c("lifesci", "physsci", "math", "psych", "eng", "edu", "arts", "other")

fields_00_prop <- phd_fields_field %>%
  filter(year == "2000",
         field == "lifesci" |
           field == "physsci" |
           field == "math" |
           field == "psych" |
           field == "eng" |
           field == "edu" |
           field == "arts" |
           field == "other") %>% 
  select("male_prop", "female_prop")

rownames(fields_00_prop) <- c("lifesci", "physsci", "math", "psych", "eng", "edu", "arts", "other")

fields00_chi <- chisq.test(fields_00)
fields00_chi
# proportions are different

#### chi square for 2015 ####

fields_15 <- phd_fields_field %>%
  filter(year == "2015",
         field == "lifesci" |
           field == "physsci" |
           field == "math" |
           field == "psych" |
           field == "eng" |
           field == "edu" |
           field == "arts" |
           field == "other") %>% 
  select("male", "female")

rownames(fields_15) <- c("lifesci", "physsci", "math", "psych", "eng", "edu", "arts", "other")

fields_15_prop <- phd_fields_field %>%
  filter(year == "2015",
         field == "lifesci" |
           field == "physsci" |
           field == "math" |
           field == "psych" |
           field == "eng" |
           field == "edu" |
           field == "arts" |
           field == "other") %>% 
  select("male_prop", "female_prop")

rownames(fields_15_prop) <- c("lifesci", "physsci", "math", "psych", "eng", "edu", "arts", "other")

fields15_chi <- chisq.test(fields_15)
fields15_chi
# proportions are different
```
In 1985, 2000, and 2015, there is a significant association between sex and PhD specialty.

```{r specialty bar graph}
#### bar of proportions ####
figure_df <- phd_fields_field %>% 
  filter(year == "1985" |
           year == "2000" |
           year == "2015") %>% 
  select("field", "year", "male", "female")
  
fields_bar <- ggplot(figure_df, aes(x = year)) +
  geom_bar() +
  facet_wrap(~field)
fields_bar
# this isn't working and i am done thinking about it
```

```{r specialty line graph}
line_df <- phd_fields_field %>% 
  filter(year == "1985" |
           year == "2000" |
           year == "2015") %>%
  select("field", "year", "female_prop")

fields_line <- ggplot(line_df, aes(x = "year", y = "female_prop", group = field)) +
  geom_point()

fields_line
```


##### Model describing faculty salary
Explore relationships between
variables in the ‘Faculty salary data (2008 - 2009 survey)’ dataset. Develop a model describing faculty
salary based on data for faculty sex, rank, years in current position, field, and number of years since
doctoral degree was earned. You should make decisions regarding which variables should remain in your
final model. Describe the results qualitatively and quantitatively (i.e., don’t just report the statistical
results of the model – make sure you describe interesting findings in text). You can also discuss any
concerns that you have with the model(s) you present, if any.

```{r all variables}
#### all variables ####
facsal_lm1 <- lm(salary ~ rank + discipline + years_since + years_service + sex, data = faculty_salary)
summary(facsal_lm1)
plot(facsal_lm1)

```

```{r rank, discipline, sex, years_since}
facsal_lm2 <- lm(salary ~ rank + discipline + sex + years_since, data = faculty_salary)
summary(facsal_lm2)
plot(facsal_lm2)
```

```{r rank, discipline, sex, years_service}
facsal_lm3 <- lm(salary ~ rank + discipline + sex + years_service, data = faculty_salary)
summary(facsal_lm3)
plot(facsal_lm3)
# doesn't look good
```

```{r rank, discipline, sex}
facsal_lm4 <- lm(salary ~ rank + discipline + sex, data = faculty_salary)
summary(facsal_lm4)
# closest adjusted r-squared to model that includes all variables
plot(facsal_lm4)
# this is probably the best one
```

```{r rank, discipline, years_since}
facsal_lm5 <- lm(salary ~ rank + discipline + years_since, data = faculty_salary)
summary(facsal_lm5)
```

```{r AIC values}
AIC_lm1 <- AIC(facsal_lm1)
AIC_lm1
# 9093.826

AIC_lm2 <- AIC(facsal_lm2)
AIC_lm2
# 9097.22

AIC_lm3 <- AIC(facsal_lm3)
AIC_lm3
# 9096.813

AIC_lm4 <- AIC(facsal_lm4)
AIC_lm4
# 9095.454

AIC_lm5 <- AIC(facsal_lm5)
AIC_lm5
# 9096.497
```





















